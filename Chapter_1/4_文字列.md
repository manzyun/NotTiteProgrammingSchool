## 文字列

### 概要
コンピューター及びPythonでの文字列の扱いと、少々リスト型データについて扱う。

### コンピューターにとって「文字」とは
今回は「文字列」データについてお伝えしようと思いますが、その前にコンピューターにとっての「文字」について復習しましょう。  
といっても、この節の内容はコンピューターの中での話なので「ふーん、そうなんだ」と鼻を鳴らしながら何となく頭の隅にでも置いておいてください。

この講座の一番最初（[コンピューターとプログラム](コンピューターとプログラム)）でも少しお話したと思いますが、コンピューターは  
「『文字コード』と呼ばれる文字の表を見ながら文字を表示したりしている」  
ということをお話したと思いますし、実際に以下のソースコードを実行して一見暗号のような16進数の羅列から文字列を表示させたと思います。

```py
#for 3.X.X
print("\x48\x65\x6c\x6c\x6f\x20\x50\x79\x74\x68\x6f\x6e")
#=> Hello Python
```

唐突ですが新しい書き方をしました。"#=> "という記号の後ろに書く内容は、一つ上の行の実行結果を表しております。  
この書き方は他の言語（主にPerlやRubyやPHP）でも使われますので、覚えていても損はないかもしれません。  
今後から、実行結果がシンプルなものや途中経過を示す場合はこのように表記します。
もちろん、"#=> "と書かれた行は、"#"の後はコメントとしてPythonでは無視される行となります。

本題に戻ります。
この時に閲覧している表つまり文字コードですが「アスキーコード」というものを閲覧しており、このアスキーコードで扱える文字は、とりあえずキーボードに書かれているひらがなと漢字以外の文字は再現できます。

なお、コンピューターでは空白や改行といった、目には見えないものも文字列として扱い、それらも文字コードには含まれております。

しかしこれでは英語圏以外の国の人達がコンピューターを使うときに不便ですよね。  
そこで日本では日本の文字コードを作成したのですが、これがいくつか種類がありそれぞれ文字の割り当てがバラバラなので、その日本語文字列を書いた時と閲覧するときの文字コードが違いますと*文字化け*という現象が起こり、全く違う文字が表示されてしまいます。  
具体的に言うと「ある漢字を入力したのに、半角カタカナと普段使わない漢字で表示されてしまう」ということが起こります。

今後皆さんが何か日本語の文字列を扱ったり、テキストファイルを読み込んだり書き込んだりするときは文字コードに気をつけてください。そうしないと、文字化けが起こって正常に表示されなかったり、同じ文字を比較しているはずなのにfalseが返されるという事が起こるかもしれません。

### コンピューターにとって「文字列」とは
ではコンピューターは「文字列」をどのように扱っているのでしょうか、そのヒントとなるかもしれないのが*配列*というデータ構造です。

配列は簡単に言うと「複数の変数をまとめたデータ構造」なのですが、ほとんどのプログラミング言語で「文字列」は「文字データ型の配列」という形で取り扱っております。
それを実感していただくためも次のソースコードを実行してみましょう。

```py
string = "Python"
for char in string:
    print(char)
#=> P
#=> y
#=> t
#=> h
#=> o
#=> n
```

横並びの文字が縦に並びましたね。
for文を初めて説明した時には理解しづらかったかもしれませんが、for文はデータリストから一つづつ要素を取り出して反復処理を行います。
今回のソースコードは「文字列変数stringから一文字ずつchar変数に代入し、表示する」という処理を書いております。

また、文字列から特定の一文字を取り出したり、特定の文字数を取り出すことも可能です。

```py
string = "Python"
# 特定の一文字を取り出す。
# 文字列変数[取り出したい文字（０から始まる）]
print(string[3])
#=> h

# 指定した位置から指定した位置までの文字を取り出す。
# 文字列変数[開始文字位置:終了文字位置 + 1]
print(stirng[2:4])
#=> th

# 指定した位置から文字列の最後までを取り出す。
# 文字列変数[開始文字位置:]
print(string[2:])
#=> thon

# 文字列の初めから指定した位置までの文字を取り出す。
# 文字列変数[:終了文字位置 + 1]
print(string[:2])
#=> Py
```

そしてPythonではこういった「配列で表現できるデータ」を*シーケンス型*と言います。
このシーケンス型についても後々お伝えするつもりですが、気になる方は独自に調べてみても構いません。

### 文字列表現色々
#### エスケープシーケンス
ではPythonの文字列表現について見てみましょう。といっても皆さん既に何度か使っておりますね。  
ダブルクォート（") で囲んだ文字は文字列となります。  
しかし、文字列の中にダブルクォートが入っていると、Pythonはコンピューターへの命令に直すときに  
「2個目のダブルクォートが出てきたぞ。ここでひとつの文字列だな」  
と解釈してしまうので、次のようなソースコードを含んでいると「文法間違いだよ」とエラーが返ってきます。

```py
message = "I want "Eggs", But you take "SPAM"."
#=> （中略）
#=> SyntaxError: invalid syntax
```

日本語であれば全角のダブルクォートを使うことで対処できますが、もしもアスキーコードで出力する場合は困ります。ということでPythonは文字列を表す記号としてシングルクォート（'）も使えます。  
なので先程のソースコードは次のように表せます。

```py
message = 'I want "Eggs", But you take "SPAM".'
```

しかし、アスキーコードで英文を表現すると、シングルクォートをアポストロフィとして使用した場合にも同じ事が起こってしまいます。

```py
message = 'I don't like "spam", But I like "SPAM".'
#=> （中略）
#=> SyntaxError: invalid syntax
```

これは困りました。「迷惑メールの”スパム”は嫌いだけど、ランチョンミートの”スパム”は好き」と書きづらいですね。

そんな時のために*エスケープシーケンス*というものがあります。シングルクォートやダブルクォートの前に「\」の記号（フォントや環境によって変わりますが、日本語環境だと「￥」の半角文字、英語圏環境だと「＼」の半角文字になります。）をつけるだけです。  
なので先程のソースコードは次のように表せます。

```py
message = 'I don\'t like "spam", But I like "SPAM".'
```

他にもエスケープシーケンスで表現できる文字は次のようなものがあります。

|エスケープシーケンス|意味|
|---|---|
|\\|\の文字そのもの|
|\'|シングルクォート|
|\"|ダブルクォート|
|\n|改行|
|\t|タブ|

#### raw文字列
しかし、時には「\」記号をエスケープシーケンスとして働かせたくない時が出てきます。特にWindowsで動くプログラムを作る際には、「\」記号はパスの区切り記号となるため、ファイルが参照できない、実行時エラーがでるなどの問題が発生します。

```py
filepath = "C:\User\boku\My Document\new files\tickets"
print(filepath)
#=> C:\Useoku\My Document
#=> ew files	ickets
```

こんな時はどうすればいいのかと言いますと、文字列データの前に「r」もしくは「R」の文字を付け加えます。

```py
filepath = r"C:\User\boku\My Document\new files\tickets"
print(filepath)
#=> C:\User\boku\My Document\new files\tickets
```

このようにすることで  
「\記号の後ろの文字は特殊な意味を表すわけではないよ」
とコンピューターに伝えることができます。このようにした文字列をPythonでは*RAW文字列*と言います

しかし注意していただきたいのが、RAW文字列にしてもシングルクォートやダブルクォートは、文字列データであると示す記号ということには変わりないので、もしシングルクォートやダブルクォートが入り混じる文字列であるならば、それらの記号はエスケープシーケンスで表現することです。
**（要調査 Python3では違う振る舞いになる。）**

#### 改行を含んだ文字列の表現
さて、改行を含んだ文字列を表現したいという時はどのようにすればいいでしょうか。  
一つはエスケープシーケンスを使って改行を表現する手法です。

```py
poem = "すばしっこい\n茶色の狐は\nのろまな犬を\n飛び越える"
print(poem)
#=> すばしっこい
#=> 茶色の狐は
#=> のろまな犬を
#=> 飛び越える
```

しかしこれがもっと長い文章だと、エスケープシーケンスで改行を加えて表現するのは骨が折れますし、ソースコードも見辛くなります。

そんな時に便利なのが*トリプルクォーテーション*です。3つ続けたシングルクォートかダブルクォートで囲ってあげるだけです。

```py
poem = """すばしっこい
茶色の狐は
のろまな犬を
飛び越える"""
print(poem)
#=> すばしっこい
#=> 茶色の狐は
#=> のろまな犬を
#=> 飛び越える
```

トリプルクォーテーションで囲まれた文字列の中では、シングルクォートやダブルクォートをエスケープシーケンスで明示的に書かなくても使うことができます。

```py
poem = """Quick "brown" fox's
jumps over
the lazy dog"""
print(poem)
#=> Quick "brown" fox's
#=> jumps over
#=> the lazy dog
```

ただし、トリプルクォーテーションの直前にトリプルクォーテーションで使用している記号を加えてしまうと、構文エラーとなってしまいますのでご注意ください。

このトリプルクォーテーションにはもうひとつの使い方があり、変数に入れなければ何も処理されないため、複数行のコメントとして使うことがあります。  
次のソースコードをコピーして実行してみましょう。

```py
'''
  ___ _   _        ____                                     _   
 |_ _| |_( )___   / ___|___  _ __ ___  _ __ ___   ___ _ __ | |_ 
  | || __|// __| | |   / _ \| '_ ` _ \| '_ ` _ \ / _ \ '_ \| __|
  | || |_  \__ \ | |__| (_) | | | | | | | | | | |  __/ | | | |_ 
 |___|\__| |___/  \____\___/|_| |_| |_|_| |_| |_|\___|_| |_|\__|
  
ここに書かれている文章は文字列型ですが処理はされません。
なので何行にもなるようなコメントや、
アスキーアートによる図解を書くときは便利かもしれません。
'''

string = '''こっちに書いている文章は変数"string"に代入される文章です。
なのでここに書いている内容はしっかりとstring変数に入って、後から呼び出すことが可能です。
ほら、こんなふうに'''

print(string)
```

どうでしょうか、printで表示された文章は変数stringに代入されたもののみが表示されたでしょうか？

### 便利な命令・関数
Pythonにも文字列を扱う際に便利な命令はいくつもあります。

####　算術演算記号
ところで、数値型の解説をする際に使った計算記号のいくつかは文字列でも使用することが可能です。
例えば”+”の記号や”*”の記号が使えます。

まず"+"は「文字の連結」に使えます。以下のようになります。
```py
string = 'Egg' + 'SPAM'
print(string)
#=> EggSPAM
```

では"*"は？　手前の文字を回数分繰り返します。
```py
string = 'SPAM! ' * 20
print(string)
#=> SPAM! SPAM! SPAM! SPAM! SPAM! SPAM! SPAM! SPAM! SPAM! SPAM! SPAM! SPAM! SPAM! SPAM! SPAM! SPAM! SPAM! SPAM! SPAM! SPAM!  
```

上記のサンプルは少々実用性が無いですね、ではこれならどうでしょう？

```py
cooking = 'とりはむ'
ingredients = ["鶏むね肉", "塩", "砂糖", "スパイス"]

print(cooking,"の作り方")
print("_/" * 20)
print("材料")
for ingredient in ingredients:
    print("*", ingredient)
print("_/" * 20)
```

#### 数値を文字列にする

ところで、input関数で数値を取り込みたいときはint()関数やfloat()関数で変換しましたが、逆に数値を文字列にしたい時もstr()関数を使います。

「そもそも文字列にしないといけない時があるの？」
と思われるかもしれませんが、以下のソースコードを実行してみると実感できるかもしれません。

```py
print("Time" + 2355)
#=> （中略）
#=> TypeError: Can't convert 'int' object to str implicitly
```

なので、上記のコードは以下のようにすると正常に動作します。

```py
print("Time" + str(2355))
#=> Time2355
```

### まとめ
今回は以下のことを頭の中にとどめておいてください。

* 文字もコンピューターの中では数値の組み合わせで管理されている
* 文字データをリストで並べたものが文字列と考えたほうがいいかもしれない。
* 文字列を数値に変換したように、数値を文字列と連結したいときは数値を文字列に変換する。

### 演習問題
今回の演習問題ですが、
「入力された文字を逆並びにして1行で表示するプログラム」
を作ってみましょう。

ヒントは今回のテキストを読み返したらあるはずです。